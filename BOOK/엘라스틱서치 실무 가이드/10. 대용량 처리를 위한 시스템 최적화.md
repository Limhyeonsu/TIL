# 10. 대용량 처리를 위한 시스템 최적화
## 10.1 노드 실행환경과 JVM 옵션(487~498p)
* 엘라스틱서치 릴리스 노트
* 실행시 자바 8 이상을 사용해야 하는 이유
  * 큰 물리 메모리 사용
  * 다수의 CPU 사용
* 항상 최신 버전의 엘라스틱서치를 사용해야 하는 이유
* 자바 8에서 제공하는 JVM 옵선
* 엘라스틱서치에 적용된 JVM 옵션

## 10.2 힙 크기를 32GB 이하로 유지해야 하는 이유
너무 작은 힙 크기는 Out Of Memory Exception을 발생시킬 수 있으며, 반대로 너무 큰 힙 크기는 FullGC가 발생할 때 시스템 전체가 마비되는 STW(stop the world) 를 발생시킬 수 있다. 

### 엘라스틱서치와 힙 크기
기본대로 설정하면 힙 크기가 1GB로 설정돼 있다. (실제 운영환경에서는 반드시 1GB보다 큰 값으로 힙 크기를 변경해야 한다.)

config 파일에서 Xms(최소 힙 크기), Xmx(최대 힙 크기) 설정 값을 변경하면 된다. 여러가지 이유로 엘라스틱서치에서 할당할 힙 크기의 최댓값으로 32GB 이하를 설정하는 것을 권장한다.

* 운영체제에 50%의 메모리 공간을 보장하자 : 실시간 검색을 지원하기 위해 루씬이 최대한 많은 시스템 캐시를 확보하도록 지원해야 한다. 그러므로 물리적인 메모리 공간의 50% 정도는 운영체제가 자유롭게 사용하도록 할당하고 나머지는 엘라스틱서치 힙으로 할당하는 것이 적절하다.
* 자바8 기반에서는 힙 크기를 32GB 이상 사용하지 말자 : 자바 기반의 애플리케이션에는 Object Pointer 정책이 모두 동일하게 적용되기 때문에 모두 최대 힙 크기를 32GB로 제한한다.

